<html><head>
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
  <title>DWARF Issue</title>
</head><body>
<body>
<table style="text-align: left; width: 800px; height: 136px;" border="0">
  <tbody>
    <tr>
      <td
 style="vertical-align: middle; text-align: center; width: 153px;"><img
 src="dwarf.png" border="0"> </td>
      <td style="width: 372px;">
      <div style="text-align: center;"> </div>
      <h1 style="text-align: center;">DWARF Standard</h1>
      <div style="text-align: center;"> </div>
      </td>
    </tr>
  </tbody>
</table>
<table style="text-align: left; width: 800px; height: 26px;" border="0"
 cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td style="width: 168px; background-color: rgb(51, 51, 255);"><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/">HOME</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/Download.html">SPECIFICATIONS</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="http://wiki.dwarfstd.dev/index.php?title=DWARF_FAQ">FAQ</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/issues.html">ISSUES</a><br>
      </td>
      <td style="width: 168px; background-color: rgb(51, 51, 255);"><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>

<table style="text-align: left; width: 794px; height: 25px;" border="1" cellpadding="2" cellspacing="2">
  <tbody>

    <tr>
      <td>141212.1</td>
      <td>Michael Eager</td>
      <td>DW_AT_export_symbols</td>
      <td>Enhancement</td>
      <td>Accepted</td>
      <td>Michael Eager</td>
    </tr>
  </tbody>
</table>
<pre><big>

Proposal 
========

Add DW_AT_export_symbols attribute to indicate that the symbols
defined within the current scope are to be exported into the enclosing
scope.

This proposal is an alternate to 141020.1.  

Background
==========

C++11 adds a new use for the keword &quot;inline&quot; as a modifier for
namespace, which exports the symbols defined within the namespace
into the enclosing scope.  From the proposed extension
Section 7.3.1:
http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3242.pdf

  &quot;Members of an inline namespace can be used in most respects as
  though they were members of the enclosing namespace.&quot;

This is similar to the use of anonymous structs in C/C++, where symbols 
within the interior struct are referenced as if they were defined 
in the enclosing structure.  


Example -- C++ inline namespace

namespace A {
  inline namespace B {   // (1) inline namespace
    int a;
  }
}

void foo (void)
{
  using A::B::a;
  a = 1;
}

void bar (void)
{
  using A::a;
  a = 2;
}


&lt;1&gt; DW_TAG_namespace
      DW_AT_name        : A        
  &lt;2&gt; DW_TAG_namespace
        DW_AT_name        : B        
        DW_AT_export_symbols     
    &lt;3&gt; DW_TAG_variable)
          DW_AT_name        : a        


In this example, 'a' may be referenced either as a member of 
the fully qualified namespace A::B, or as if it were defined
in the enclosing namespace, A.


Example -- C/C++ anonymous structs

struct foo {
  int a;
  struct {
    int b;
  };
} x;

void bar(void)
{
  struct foo t;
  t.a = 1;
  t.b = 2;
}


&lt;1&gt; DW_TAG_structure_type  
      DW_AT_name (foo)
  &lt;2&gt; DW_TAG_member
        DW_AT_name (a)
  &lt;3&gt; DW_TAG_structure_type
        DW_AT_export_symbols
    &lt;4&gt; DW_TAG_member
          DW_AT_name (b)
                
In this example, 'b' is referenced as if it were defined in the 
enclosing struct 'foo'. 
          
          
Note:  GCC currently generates the following DWARF, with the nested
anonymous struct described as being at top-level, rather than within
struct foo, and with an unnamed member within struct foo with the
type of the anonymous struct.

&lt;1&gt; DW_TAG_structure_type
  &lt;2&gt; DW_TAG_member
        DW_AT_name (b)
&lt;3&gt; DW_TAG_structure_type
      DW_AT_name (foo)
  &lt;4&gt; DW_TAG_member
        DW_AT_name (a)
  &lt;5&gt; DW_TAG_member
        DW_AT_type &lt;1&gt;   


Document changes
================

Add to Table 2.2 (Attribute names)

  DW_AT_export_symbols  Namespace Entries
			Structure, Union and Class Type Entries

Add to end of 3.2.2 (Namespace Entries)

  A namespace may have a DW_AT_export_symbols attribute which indicates
  that all member names defined within the namespace may be referenced 
  as if they were defined within the containing namespace. 
  <i>This may be used to describe inline namespaces in C++.</i>


Add to end of 5.7.1 (Structure, Union and Class Type Entries)

  A structure, union, or class type may have a DW_AT_export_symbols
  attribute which indicates that all member names defined within 
  the structure, union, or class may be referenced as if they were
  defined within the containing structure, union, or class. 
  <i>This may be used to describe anonymous structs, etc., in C or C++.</i>

Add to Table 7.5 (Attribute encodings)

  DW_AT_export_symbols  0x89  flag

Modify Table A.1
  DW_TAG_class_type     -- Add DW_AT_export_symbols
  DW_TAG_namespace      -- Add DW_AT_export_symbols
  DW_TAG_structure_type -- Add DW_AT_export_symbols
  DW_TAG_union_type     -- Add DW_AT_export_symbols



</big></pre>
<br><br>

<table style="text-align: left; width: 800px;" border="0" cellpadding="0" cellspacing="0">
  <small>
  </small><tbody><small>
    </small><tr><small>
      </small><td style="width: 800px; text-align: center;"><small>
      <font class="footmsg">
All logos and trademarks in this site are property of their respective
owner. <br>
The comments are property of their posters, all the rest &copy; 2007-2022
by DWARF Standards Committee.</font></small></td><small>
    </small></tr><small>
  </small></tbody><small>
  </small>
</table>

</body></html>
