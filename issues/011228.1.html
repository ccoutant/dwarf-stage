<html><head>
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
  <title>DWARF Issue</title>
</head><body>
<body>
<table style="text-align: left; width: 800px; height: 136px;" border="0">
  <tbody>
    <tr>
      <td
 style="vertical-align: middle; text-align: center; width: 153px;"><img
 src="dwarf.png" border="0"> </td>
      <td style="width: 372px;">
      <div style="text-align: center;"> </div>
      <h1 style="text-align: center;">DWARF Standard</h1>
      <div style="text-align: center;"> </div>
      </td>
    </tr>
  </tbody>
</table>
<table style="text-align: left; width: 800px; height: 26px;" border="0"
 cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td style="width: 168px; background-color: rgb(51, 51, 255);"><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/">HOME</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/Download.html">SPECIFICATIONS</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="http://wiki.dwarfstd.dev/index.php?title=DWARF_FAQ">FAQ</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/issues.html">ISSUES</a><br>
      </td>
      <td style="width: 168px; background-color: rgb(51, 51, 255);"><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>

<table style="text-align: left; width: 794px; height: 25px;" border="1" cellpadding="2" cellspacing="2">
  <tbody>

    <tr>
      <td>011228.1</td>
      <td>David Anderson</td>
      <td>UTF-8 Clarification</td>
      <td>Clarification</td>
      <td>Accepted with modifications</td>
      <td>Dave Anderson</td>
    </tr>
  </tbody>
</table>
<pre><big>

BACKGROUND
----------

Dave Anderson posted several questions on 28-Dec-2001 about the
UTF-8 attribute and how it interacts with sections other than
debug_info (in which it is contained). Brender responded with
some tentative answers and further suggested that at minimum
additional italics commentary seemed warranted in several places.


THE DIALOG SO FAR
-----------------

Dave Anderson wrote:
&gt;I wonder if there is a problem with the DW_AT_UTF8 attribute.
&gt;An introduction to UTF8 is on
&gt;http://www.unicode.org/unicode/uni2book/u2.html
&gt;in Chapter 2, General Structure, on page 12 of 26 in that pdf chapter.
&gt;
&gt;I am afflicted with ignorance on this in spite of reading
&gt;the above info...
&gt;
&gt;One point: for all values in the range [0..127] unicode and
&gt;ASCII are identical, which may make a difference...

By design, of course...


&gt;Perhaps there is no problem, but I wonder.
&gt;
&gt;UTF8 contains solely 8bit characters, so ordinary
&gt;string processing won't go haywire reading them, but
&gt;on the other hand, I worry that in a couple cases below
&gt;it might be *necessary* to know that
&gt;a string is UTF8 but with no appropriate way to tell.
&gt;
&gt;I would be happy to learn my concerns are unfounded, so
&gt;feel free to clear this up for me...
&gt;
&gt;3.1  DW_AT_UTF8 says that &quot;all strings use UTF8&quot; in that CU.
&gt;
&gt;This is clearly fine for
&gt;	.debug_info
&gt;	.debug_strp
&gt;
&gt; .debug_line
&gt;	This has file names etc.
&gt;	This is perhaps sensibly looked at as an 'extension' of
&gt;	.debug_info.  Are these utf8? I guess so.
&gt;        It's not read independent of .debug_info so this seems ok.

debug_line does have its own version number field. So, if it version 3
then I think it reasonable to expect that it depends on the use_UTF8
attribute of the compilation unit.

An italics comment to this effect seems appropriate someplace.


&gt; .debug_macinfo
&gt;	has strings.
&gt;	This is perhaps sensibly looked at as an 'extension' of
&gt;	.debug_info.  Are these utf8? I guess so.
&gt;       It's not read independent of .debug_info so this seems ok.

debug_macinfo does not have it's own version number, so the argument
is not quite so direct as for .debug_line. Still, I would expect that
debug_macinfo is equally dependent on the unit use_UTF8 attribute.

An italics comment to this effect seems appropriate someplace.

    Aside: Of course, C (C99) has its own quite different source scheme
    for representing multibyte characters. But, since that scheme is
    defined in terms of the &quot;C character set&quot;, which is a subset of
    7-bit ASCII (and its international equivalents), I think there is
    nothing that prevents its use in combination with UTF-8 (although
    one might hope that no producer would do so!).


&gt;However, the following sections also have strings and
&gt;things are  slightly less clear to me.
&gt;
&gt; .debug_frame can have an augmentation string
&gt;	Is this utf8?

Hmmm, very interesting...

&gt;	What if .debug_frame is used for exceptions, so exists
&gt;	in stripped executables? .debug_frame may be
&gt;	gone!  So then what?

Clearly the behavior of exception handling better not depend on whether
the executable is stripped or not!

If .debug_frame is gone, then the question is moot, yes?

&gt;	Document/dwarf3 mistake or
&gt;	quality-of-implementation issue or ???
&gt;	.debug_frame is 'independent' of .debug_info.... No direct
&gt;	connection to a CU in .debug_info.

Me thinks there is a real DWARF3 issue. Not sure how best to resolve it.


&gt; .debug_pubnames has name strings
&gt; .debug_pubtypes has name strings.
&gt;	Till one actually has *found* the relevant
&gt;	compilation unit then these strings cannot
&gt;	be usefully printed?
&gt;	Will searches work if some CUs are utf8 but not all?
&gt;	Is this a quality of implementation issue or a
&gt;	dwarf3 issue?
&gt;	These *are* searched independent of .debug_info, though
&gt;	the do reference .debug_info.
&gt;	Document/dwarf3 mistake or quality-of-implementation issue or ???

Well, searches can work given a mixture of UTF8 and non-UTF-8; to do so
requires that the consumer look into the corresponding compilation unit
header before doing the search. Not hard, but definitely a new wrinkle.

Worth at least an italics explanation.


RECOMMENDED ACTION
------------------

The email Ron responds to has a typo.
I meant to say that since .debug_frame can be present
yet .debug_info absent, what is supposed to happen?
Which Ron has noted as a key issue.

So I'm floating the following proposal for consideration.
(the existing ISSUE has no proposal)


PROPOSAL (ref draft 8/9, dwarf3):


x means the text is to orient the proposal reader and
x document editor, the
x literal proposed text below has no leading &gt;.

xThe proposal is that the .debug_frame augmentation always
xbe ISO-IEC 10646-1:1993, never UFT8.  
xGiven the string is a compiler flag, 
xthere is no need to handle user-level names.




x6.4.1

x4. Augmentation (string)

xAdd the following to bullet 4:

Augmentation string must use ISO/IEC 10646-1:1993, not UTF8.
The string is (thus) independent of DW_AT_use_UTF8.


x7.5.4  Attribute Encodings
xAt the end of the 'string' attribute discussion, add the following:

Because .debug_frame is useful independently of .debug_info the
augmentation string of .debug_frame must be ISO/IEC 10646-1:1993, not UTF8
(the augmentation format is thus independent of DW_AT_use_UTF8).

=============================================================
5/17/2005:  Accepted with modification:
  In the proposal, where it says ISO-10646, it should read
  ISO-646.  The latter is LATIN-1, the former is UCS-2/4.

  The Augmentation string will be UTF-8 encoded in 6.4.1. 
  No changed text in 7.5.4.
</big></pre>
<br><br>

<table style="text-align: left; width: 800px;" border="0" cellpadding="0" cellspacing="0">
  <small>
  </small><tbody><small>
    </small><tr><small>
      </small><td style="width: 800px; text-align: center;"><small>
      <font class="footmsg">
All logos and trademarks in this site are property of their respective
owner. <br>
The comments are property of their posters, all the rest &copy; 2007-2022
by DWARF Standards Committee.</font></small></td><small>
    </small></tr><small>
  </small></tbody><small>
  </small>
</table>

</body></html>
