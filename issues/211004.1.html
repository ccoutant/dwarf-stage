<html><head>
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
  <title>DWARF Issue</title>
</head><body>
<body>
<table style="text-align: left; width: 800px; height: 136px;" border="0">
  <tbody>
    <tr>
      <td
 style="vertical-align: middle; text-align: center; width: 153px;"><img
 src="dwarf.png" border="0"> </td>
      <td style="width: 372px;">
      <div style="text-align: center;"> </div>
      <h1 style="text-align: center;">DWARF Standard</h1>
      <div style="text-align: center;"> </div>
      </td>
    </tr>
  </tbody>
</table>
<table style="text-align: left; width: 800px; height: 26px;" border="0"
 cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td style="width: 168px; background-color: rgb(51, 51, 255);"><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/">HOME</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/Download.html">SPECIFICATIONS</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="http://wiki.dwarfstd.dev/index.php?title=DWARF_FAQ">FAQ</a><br>
      </td>
      <td
 style="text-align: center; background-color: rgb(51, 51, 255);"><a
 style="color: rgb(255, 255, 255);"
 href="/issues.html">ISSUES</a><br>
      </td>
      <td style="width: 168px; background-color: rgb(51, 51, 255);"><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>

<table style="text-align: left; width: 794px; height: 25px;" border="1" cellpadding="2" cellspacing="2">
  <tbody>

    <tr>
      <td>211004.1</td>
      <td>Paul Robinson</td>
      <td>Replace DW_MACRO_define/undef_sup with sized versions</td>
      <td>Enhancement</td>
      <td>Accepted with modifications</td>
      <td>Jeremy Morse</td>
    </tr>
  </tbody>
</table>
<pre><big>

Section various, pg various
Background:

As for DW_FORM_ref_sup[4,8], and issue 181026.2 which proposes a similar
pair of forms to replace DW_FORM_strp_sup, the macro definition opcodes
should allow distinguishing between 4-byte and 8-byte offsets within a
supplementary object file, and not assume the supplementary file and all
referencing files use the same 32/64 format.

Proposed changes to the specification:

Section 6.3.1 Macro Information Header

On p.166, lines 11-13, in the description of the `offset_size_flag` 
add a sentence saying:
  This flag does not apply to the opcodes DW_MACRO_define_sup4,
  DW_MACRO_define_sup8, DW_MACRO_undef_sup4, and DW_MACRO_define_sup8.


Section 6.3.2.1 Define and Undefine Entries

On p.168, lines 17-23, replace item 4 (DW_MACRO_define_sup, DW_MACRO_undef_sup)
with the following (making the offset size dependent on the opcode
rather than the `offset_size_flag` field):

4. DW_MACRO_define_sup4, DW_MACRO_define_sup8, DW_MACRO_undef_sup4,
   DW_MACRO_undef_sup8
    A DW_MACRO_define_sup4, DW_MACRO_define_sup8, DW_MACRO_undef_sup4,
    or DW_MACRO_undef_sup8 entry has two operands.  The first operand
    encodes the line number of the `#define` or `#undef` macro directive.
    The second operand identifies a string; it is represented as an 
    4-byte (DW_MACRO_define_sup4, DW_MACRO_undef_sup4) or 8-byte
    (DW_MACRO_define_sup8, DW_MACRO_undef_sup8) offset into the 
    `.debug_str` section of the supplementary object file.


Section 6.3.2.2 Macro Define String

On p.168 line 28, replace &quot;DW_MACRO_define_sup&quot; with &quot;DW_MACRO_define_sup4
or DW_MACRO_define_sup8&quot;.


Section 6.3.2.3 Macro Undefine String

On p.168 line 8, replace &quot;DW_MACRO_undef_sup&quot; with &quot;DW_MACRO_undef_sup4
or DW_MACRO_undef_sup8&quot;.


Section 6.3.3.2 Importation of Macro Units

On p.170, lines 24-29, replace the title and first paragraph of item 2
(DW_MACRO_import_sup) with the following:

2. DW_MACRO_import_sup4, DW_MACRO_import_sup8
    A DW_MACRO_import_sup4 or DW_MACRO_import_sup8 entry has one operand,
    a 4-byte (DW_MACRO_import_sup4) or 8-byte (DW_MACRO_import_sup8) offset
    from the start of the `.debug_macro` section in the supplementary object
    file.  Apart from the different location in which to find the macro 
    unit, these entry types are equivalent to DW_MACRO_import.


Section 7.3.6 DWARF Supplementary Object Files

On p.195, lines 28, replace &quot;DW_MACRO_define_sup or DW_MACRO_undef_sup&quot;
with &quot;DW_MACRO_define_sup4, DW_MACRO_define_sup8, DW_MACRO_undef_sup4
or DW_MACRO_undef_sup8&quot;.

On p.195, line 30, replace &quot;DW_MACRO_import_sup&quot; with &quot;DW_MACRO_import_sup4
or DW_MACRO_import_sup8&quot;.

Issue 181026.2 adds a non-normative paragraph to this section; probably it
should go at the end of the entire section, as it applies to both the forms
and macro directives.

--
2022-10-31:  Accepted with modifications:
   Add DW_MACRO_import_sup{4,8} in 6.3.1.
   Change the second mention of DW_MACRO_define_sup8 to DW_MACRO_undef_sup8.
</big></pre>
<br><br>

<table style="text-align: left; width: 800px;" border="0" cellpadding="0" cellspacing="0">
  <small>
  </small><tbody><small>
    </small><tr><small>
      </small><td style="width: 800px; text-align: center;"><small>
      <font class="footmsg">
All logos and trademarks in this site are property of their respective
owner. <br>
The comments are property of their posters, all the rest &copy; 2007-2022
by DWARF Standards Committee.</font></small></td><small>
    </small></tr><small>
  </small></tbody><small>
  </small>
</table>

</body></html>
